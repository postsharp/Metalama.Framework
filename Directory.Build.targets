<Project>

    <Import Sdk="PostSharp.Engineering.Sdk" Project="AssemblyMetadata.targets" />
    <Import Sdk="PostSharp.Engineering.Sdk" Project="TeamCity.targets" />

    <ItemGroup>
        <!-- Specifically use the same version of Roslyn as we're using in Metalama Compiler -->
        <PackageReference Include="Microsoft.Net.Compilers.Toolset" Version="$(RoslynVersion)"
                          Condition="'$(UseMetalamaCompiler)'==''">
            <PrivateAssets>all</PrivateAssets>
            <IncludeAssets>runtime; build; native; contentfiles; analyzers</IncludeAssets>
        </PackageReference>
        <PackageReference Include="Metalama.Compiler" Version="$(MetalamaCompilerVersion)" PrivateAssets="all"
                          Condition="'$(UseMetalamaCompiler)'=='Private'" />
        <PackageReference Include="Metalama.Compiler" Version="$(MetalamaCompilerVersion)"
                          Condition="'$(UseMetalamaCompiler)'=='Public'" />
    </ItemGroup>

    <PropertyGroup>
        <!-- When debugging the release build, disable optimizations. -->
        <!-- <Optimize>False</Optimize> -->
    </PropertyGroup>

    <!-- Test projects specific settings. -->
    <!-- This is not placed in Directory.Build.props as the IsTestProject property is not yet set there. -->
    <ItemGroup Condition="'$(IsTestProject)'=='true'">
        <!-- We include this to disable xUnit shadow copying because it is not compatible with public-signed test assemblies. -->
        <!-- The same is used by Arcade in Roslyn. -->
        <Content Include="$(MSBuildThisFileDirectory)eng\xunit.runner.json" Link="%(Filename)%(Extension)" CopyToOutputDirectory="PreserveNewest" />
    </ItemGroup>

</Project>