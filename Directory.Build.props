<Project>

    <PropertyGroup>
        <RepoDirectory>$(MSBuildThisFileDirectory)</RepoDirectory>
        <RepoKind>AzureRepos</RepoKind>
    </PropertyGroup>

    <Import Project="eng\Versions.props" />
    <Import Project="eng\StrongName.props" />
    <Import Project="eng\Packaging.props" />

    <!-- Imports a script that exports a few MSBuild properties to the compiler. We try to import and not to copy to avoid duplication. -->
    <Import Project="Metalama.Framework.Package\Metalama.CompilerVisibleProperties.props" />

    <Import Sdk="PostSharp.Engineering.Sdk" Project="BuildOptions.props" />
    <Import Sdk="PostSharp.Engineering.Sdk" Project="CodeQuality.props" />
    <Import Sdk="PostSharp.Engineering.Sdk" Project="SourceLink.props" />
    
    <PropertyGroup Condition="'$(Configuration)'=='Release'">
    <!-- CS8602: Dereference of a possibly null reference.
        CS8604: Possible null reference argument for parameter 'x' in 'y'.
        
         The compiler will emit these warnings if we have aggressive inlining. This should not be important for code quality.     -->
        <NoWarn>$(NoWarn);CS8602;CS8604</NoWarn>
    </PropertyGroup>

    <PropertyGroup>
        <!--
            Licensee: SharpCrafters s.r.o.
            Product: Metalama
            Namespace: Metalama
        -->
        <MetalamaLicense>1-ZEQQQQQQZEAEQCRCE4UW3UFEB4URXMHRB8KQBJJSB64LX7YQEUTZXJSRN4JUNTDAEAKZ2NUP6MCEBAXNKGL7VGZ48JHT6G3EGQREL8WQVM74EY4RC774B6HP6X5QQ35M5MZQQDEZJGP4Q8USJG4X6P2</MetalamaLicense>
    </PropertyGroup>


    <!-- Include the package version in metadata. -->
    <Target Name="AddAssemblyMetadata"
            BeforeTargets="GenerateAdditionalSources"
            DependsOnTargets="RunResolvePackageDependencies">

        <ItemGroup>
            <!-- Add all package versions to metadata -->
            <AssemblyAttribute Include="System.Reflection.AssemblyMetadataAttribute">
                <_Parameter1>Package:%(PackageDefinitions.Name)</_Parameter1>
                <_Parameter2>%(PackageDefinitions.Version)</_Parameter2>
            </AssemblyAttribute>
        </ItemGroup>

    </Target>

</Project>